######
Risk: Low

ICMP Timestamp Request Remote Date Disclosure
Description
The remote host answers to an ICMP timestamp request. This allows an attacker to know the date that is set on the targeted machine, which may assist an unauthenticated, remote attacker in defeating time-based authentication protocols.

Timestamps returned from machines running Windows Vista / 7 / 2008 / 2008 R2 are deliberately incorrect, but usually within 1000 seconds of the actual system time.
Solution
Filter out the ICMP timestamp requests (13), and the outgoing ICMP timestamp replies (14).
Output
The difference between the local and remote clocks is 1 second.


Recommended Fix (for Ubuntu with UFW — the default on most Ubuntu servers/desktops)
UFW (Uncomplicated Firewall) is iptables-based and does not block ICMP timestamp by default, but it's easy to add rules by editing the configuration.

Edit the UFW before.rules file:Bashsudo nano /etc/ufw/before.rules
Add the following two rules just before the final COMMIT line (typically near the end of the file, after the other ICMP rules but before *filter ends and COMMIT):text# Drop ICMP timestamp requests (type 13) and replies (type 14)
-A ufw-before-input -p icmp --icmp-type timestamp-request -j DROP
-A ufw-before-input -p icmp --icmp-type timestamp-reply -j DROPThe file will look something like this at the bottom (your existing rules may vary slightly):text# ok icmp codes for INPUT
-A ufw-before-input -p icmp --icmp-type destination-unreachable -j ACCEPT
-A ufw-before-input -p icmp --icmp-type source-quench -j ACCEPT
-A ufw-before-input -p icmp --icmp-type time-exceeded -j ACCEPT
-A ufw-before-input -p icmp --icmp-type parameter-problem -j ACCEPT
-A ufw-before-input -p icmp --icmp-type echo-request -j ACCEPT

# Drop ICMP timestamp requests and replies
-A ufw-before-input -p icmp --icmp-type timestamp-request -j DROP
-A ufw-before-input -p icmp --icmp-type timestamp-reply -j DROP

COMMIT
Save and apply:Bashsudo ufw reload

This fully mitigates the issue without breaking normal ICMP functionality (e.g., ping, path MTU discovery).
Alternative:


Direct iptables (if UFW is disabled or you prefer raw rules)


sudo iptables -I INPUT -p icmp --icmp-type timestamp-request -j DROP
sudo iptables -I INPUT -p icmp --icmp-type timestamp-reply -j DROP


# Make persistent (Ubuntu uses iptables-persistent or netfilter-persistent)


sudo apt install iptables-persistent   # if not installed
sudo netfilter-persistent save


Verification


After applying the rules, test from another host:


Using nping (from nmap package)
nping --icmp --icmp-type timestamp <your-ubuntu-ip>



# Or hping3
sudo hping3 --icmp-ts <your-ubuntu-ip>
You should now see no response or "filtered".

Notes

This change is safe — ICMP timestamp is almost never legitimately needed on modern networks.
If you have an external firewall/router (e.g., cloud provider security groups, AWS, GCP, Azure), block ICMP types 13/14 there as well for defense-in-depth.
Rescanning with Nessus should now show the issue as resolved.

This is the cleanest, most widely recommended method on Ubuntu systems.
